+ module load miniforge/24.11.3-2
+ unset _mlshdbg
+ '[' 0 = 1 ']'
+ unset _mlre _mlIFS
+ '[' -n x ']'
+ _mlIFS=' 	
'
+ IFS=' '
+ '[' -n '' ']'
++ /usr/bin/tclsh /cm/local/apps/environment-modules/4.5.3/libexec/modulecmd.tcl bash load miniforge/24.11.3-2
+ eval
+ _mlstatus=0
+ '[' -n x ']'
+ IFS=' 	
'
+ unset _mlre _mlv _mlrv _mlIFS
+ '[' -n '' ']'
+ unset _mlshdbg
+ return 0
++ conda info --base
+ source /apps/miniforge/24.11.3/etc/profile.d/conda.sh
++ export CONDA_EXE=/apps/miniforge/24.11.3/bin/conda
++ CONDA_EXE=/apps/miniforge/24.11.3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/apps/miniforge/24.11.3/bin/python
++ CONDA_PYTHON_EXE=/apps/miniforge/24.11.3/bin/python
++ '[' -z x ']'
+ conda activate hybrid_loss
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate hybrid_loss
+ '[' -n '' ']'
+ local ask_conda
++ PS1=
++ __conda_exe shell.posix activate hybrid_loss
++ /apps/miniforge/24.11.3/bin/conda shell.posix activate hybrid_loss
+ ask_conda='PS1='\''(hybrid_loss) '\''
export PATH='\''/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin'\''
export CONDA_SHLVL='\''1'\''
export CONDA_PROMPT_MODIFIER='\''(hybrid_loss) '\''
export CONDA_EXE='\''/apps/miniforge/24.11.3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/apps/miniforge/24.11.3/bin/python'\'''
+ eval 'PS1='\''(hybrid_loss) '\''
export PATH='\''/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin'\''
export CONDA_SHLVL='\''1'\''
export CONDA_PROMPT_MODIFIER='\''(hybrid_loss) '\''
export CONDA_EXE='\''/apps/miniforge/24.11.3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/apps/miniforge/24.11.3/bin/python'\'''
++ PS1='(hybrid_loss) '
++ export PATH=/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin
++ PATH=/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin
++ export CONDA_SHLVL=1
++ CONDA_SHLVL=1
++ export 'CONDA_PROMPT_MODIFIER=(hybrid_loss) '
++ CONDA_PROMPT_MODIFIER='(hybrid_loss) '
++ export CONDA_EXE=/apps/miniforge/24.11.3/bin/conda
++ CONDA_EXE=/apps/miniforge/24.11.3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/apps/miniforge/24.11.3/bin/python
++ CONDA_PYTHON_EXE=/apps/miniforge/24.11.3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ module load cuda/12.4.1
+ unset _mlshdbg
+ '[' 0 = 1 ']'
+ unset _mlre _mlIFS
+ '[' -n x ']'
+ _mlIFS=' 	
'
+ IFS=' '
+ '[' -n '' ']'
++ /usr/bin/tclsh /cm/local/apps/environment-modules/4.5.3/libexec/modulecmd.tcl bash load cuda/12.4.1
+ eval 'CPLUS_INCLUDE_PATH_modshare=/apps/cuda/12.4.1/include:1;' export 'CPLUS_INCLUDE_PATH_modshare;
CPATH=/apps/cuda/12.4.1/include:/cm/shared/apps/slurm/current/include;' export 'CPATH;
LD_LIBRARY_PATH=/apps/cuda/12.4.1/lib64:/cm/shared/apps/slurm/current/lib64/slurm:/cm/shared/apps/slurm/current/lib64;' export 'LD_LIBRARY_PATH;
CUDAROOT=/apps/cuda/12.4.1;' export 'CUDAROOT;
LIBRARY_PATH=/apps/cuda/12.4.1/lib64/stubs:/apps/cuda/12.4.1/lib64:/cm/shared/apps/slurm/current/lib64/slurm:/cm/shared/apps/slurm/current/lib64;' export 'LIBRARY_PATH;
_LMFILES_=/cm/local/modulefiles/slurm/slurm/23.02.8:/cm/shared/modulefiles/default-environment:/cm/shared/modulefiles/miniforge/24.11.3-2:/cm/shared/modulefiles/cuda/12.4.1;' export '_LMFILES_;
LOADEDMODULES=slurm/slurm/23.02.8:default-environment:miniforge/24.11.3-2:cuda/12.4.1;' export 'LOADEDMODULES;
CUDAPATH=/apps/cuda/12.4.1;' export 'CUDAPATH;
MODULES_LMCONFLICT=miniforge/24.11.3-2\&miniforge:cuda/12.4.1\&cuda;' export 'MODULES_LMCONFLICT;
LIBRARY_PATH_modshare=/cm/shared/apps/slurm/current/lib64:1:/apps/cuda/12.4.1/lib64/stubs:1:/apps/cuda/12.4.1/lib64:1:/cm/shared/apps/slurm/current/lib64/slurm:1;' export 'LIBRARY_PATH_modshare;
C_INCLUDE_PATH_modshare=/apps/cuda/12.4.1/include:1;' export 'C_INCLUDE_PATH_modshare;
MODULES_LMCONFLICT_modshare=cuda/12.4.1\&cuda:1:miniforge/24.11.3-2\&miniforge:1;' export 'MODULES_LMCONFLICT_modshare;
CPLUS_INCLUDE_PATH=/apps/cuda/12.4.1/include;' export 'CPLUS_INCLUDE_PATH;
C_INCLUDE_PATH=/apps/cuda/12.4.1/include;' export 'C_INCLUDE_PATH;
CPATH_modshare=/apps/cuda/12.4.1/include:1:/cm/shared/apps/slurm/current/include:1;' export 'CPATH_modshare;
LD_LIBRARY_PATH_modshare=/cm/shared/apps/slurm/current/lib64:1:/apps/cuda/12.4.1/lib64:1:/cm/shared/apps/slurm/current/lib64/slurm:1;' export 'LD_LIBRARY_PATH_modshare;
CUDAVERSION=12.4.1;' export 'CUDAVERSION;
_LMFILES__modshare=/cm/shared/modulefiles/cuda/12.4.1:1:/cm/shared/modulefiles/miniforge/24.11.3-2:1:/cm/local/modulefiles/slurm/slurm/23.02.8:1:/cm/shared/modulefiles/default-environment:1;' export '_LMFILES__modshare;
LOADEDMODULES_modshare=cuda/12.4.1:1:miniforge/24.11.3-2:1:slurm/slurm/23.02.8:1:default-environment:1;' export 'LOADEDMODULES_modshare;
PATH=/apps/cuda/12.4.1/bin:/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin;' export 'PATH;
PATH_modshare=/usr/bin:1:/apps/cuda/12.4.1/bin:1:/usr/local/bin:1:/cm/shared/apps/slurm/current/bin:1:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:1:/cm/shared/apps/slurm/current/sbin:1:/bin:1:/snap/bin:1:/sbin:1:/usr/sbin:1:/cm/local/apps/environment-modules/4.5.3/bin:1:/apps/miniforge/24.11.3/condabin:1:/usr/games:1:/usr/local/sbin:1:/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:1:/usr/local/games:1;' export 'PATH_modshare;
test' '0;'
++ CPLUS_INCLUDE_PATH_modshare=/apps/cuda/12.4.1/include:1
++ export CPLUS_INCLUDE_PATH_modshare
++ CPATH=/apps/cuda/12.4.1/include:/cm/shared/apps/slurm/current/include
++ export CPATH
++ LD_LIBRARY_PATH=/apps/cuda/12.4.1/lib64:/cm/shared/apps/slurm/current/lib64/slurm:/cm/shared/apps/slurm/current/lib64
++ export LD_LIBRARY_PATH
++ CUDAROOT=/apps/cuda/12.4.1
++ export CUDAROOT
++ LIBRARY_PATH=/apps/cuda/12.4.1/lib64/stubs:/apps/cuda/12.4.1/lib64:/cm/shared/apps/slurm/current/lib64/slurm:/cm/shared/apps/slurm/current/lib64
++ export LIBRARY_PATH
++ _LMFILES_=/cm/local/modulefiles/slurm/slurm/23.02.8:/cm/shared/modulefiles/default-environment:/cm/shared/modulefiles/miniforge/24.11.3-2:/cm/shared/modulefiles/cuda/12.4.1
++ export _LMFILES_
++ LOADEDMODULES=slurm/slurm/23.02.8:default-environment:miniforge/24.11.3-2:cuda/12.4.1
++ export LOADEDMODULES
++ CUDAPATH=/apps/cuda/12.4.1
++ export CUDAPATH
++ MODULES_LMCONFLICT='miniforge/24.11.3-2&miniforge:cuda/12.4.1&cuda'
++ export MODULES_LMCONFLICT
++ LIBRARY_PATH_modshare=/cm/shared/apps/slurm/current/lib64:1:/apps/cuda/12.4.1/lib64/stubs:1:/apps/cuda/12.4.1/lib64:1:/cm/shared/apps/slurm/current/lib64/slurm:1
++ export LIBRARY_PATH_modshare
++ C_INCLUDE_PATH_modshare=/apps/cuda/12.4.1/include:1
++ export C_INCLUDE_PATH_modshare
++ MODULES_LMCONFLICT_modshare='cuda/12.4.1&cuda:1:miniforge/24.11.3-2&miniforge:1'
++ export MODULES_LMCONFLICT_modshare
++ CPLUS_INCLUDE_PATH=/apps/cuda/12.4.1/include
++ export CPLUS_INCLUDE_PATH
++ C_INCLUDE_PATH=/apps/cuda/12.4.1/include
++ export C_INCLUDE_PATH
++ CPATH_modshare=/apps/cuda/12.4.1/include:1:/cm/shared/apps/slurm/current/include:1
++ export CPATH_modshare
++ LD_LIBRARY_PATH_modshare=/cm/shared/apps/slurm/current/lib64:1:/apps/cuda/12.4.1/lib64:1:/cm/shared/apps/slurm/current/lib64/slurm:1
++ export LD_LIBRARY_PATH_modshare
++ CUDAVERSION=12.4.1
++ export CUDAVERSION
++ _LMFILES__modshare=/cm/shared/modulefiles/cuda/12.4.1:1:/cm/shared/modulefiles/miniforge/24.11.3-2:1:/cm/local/modulefiles/slurm/slurm/23.02.8:1:/cm/shared/modulefiles/default-environment:1
++ export _LMFILES__modshare
++ LOADEDMODULES_modshare=cuda/12.4.1:1:miniforge/24.11.3-2:1:slurm/slurm/23.02.8:1:default-environment:1
++ export LOADEDMODULES_modshare
++ PATH=/apps/cuda/12.4.1/bin:/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:/apps/miniforge/24.11.3/condabin:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:/cm/shared/apps/slurm/current/sbin:/cm/shared/apps/slurm/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/sbin:/usr/sbin:/cm/local/apps/environment-modules/4.5.3/bin
++ export PATH
++ PATH_modshare=/usr/bin:1:/apps/cuda/12.4.1/bin:1:/usr/local/bin:1:/cm/shared/apps/slurm/current/bin:1:/home/users/astar/cfar/stuananthu/.vscode-server/cli/servers/Stable-18e3a1ec544e6907be1e944a94c496e302073435/server/bin/remote-cli:1:/cm/shared/apps/slurm/current/sbin:1:/bin:1:/snap/bin:1:/sbin:1:/usr/sbin:1:/cm/local/apps/environment-modules/4.5.3/bin:1:/apps/miniforge/24.11.3/condabin:1:/usr/games:1:/usr/local/sbin:1:/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/bin:1:/usr/local/games:1
++ export PATH_modshare
++ test 0
+ _mlstatus=0
+ '[' -n x ']'
+ IFS=' 	
'
+ unset _mlre _mlv _mlrv _mlIFS
+ '[' -n '' ']'
+ unset _mlshdbg
+ return 0
+ export CUDA_HOME=/apps/cuda/12.4.1
+ CUDA_HOME=/apps/cuda/12.4.1
+ export PRJ=prj0000000224
+ PRJ=prj0000000224
+ export SCRATCH=/scratch/prj0000000224
+ SCRATCH=/scratch/prj0000000224
+ export HF_HOME=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface
+ HF_HOME=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface
+ export TRANSFORMERS_CACHE=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers
+ TRANSFORMERS_CACHE=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers
+ export HF_DATASETS_CACHE=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets
+ HF_DATASETS_CACHE=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets
+ export TMPDIR=/scratch/prj0000000224/tmp/stuananthu
+ TMPDIR=/scratch/prj0000000224/tmp/stuananthu
+ mkdir -p /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets /scratch/prj0000000224/tmp/stuananthu
+ CACHE_ROOT=/scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets
+ echo '[preflight] clearing cached JSON datasets under: /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets/json'
+ rm -rf /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/datasets/json
+ export PYTHONUNBUFFERED=1
+ PYTHONUNBUFFERED=1
+ export HF_DATASETS_TRUST_REMOTE_CODE=1
+ HF_DATASETS_TRUST_REMOTE_CODE=1
+ export TOKENIZERS_PARALLELISM=false
+ TOKENIZERS_PARALLELISM=false
+ export PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
+ MODEL_DIR=/home/users/astar/cfar/stuananthu/LLMDiversity/results/qwen2-7b/phase5_sparsemax/checkpoint-1434
+ RUN_NAME=qwen2_sparsemax_eval_20250906-0009
+ OUT_DIR=/home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009
+ USE_VLLM=True
+ N_RESP=32
+ BATCH_SIZE=8
+ RM_BATCH_SIZE=2
+ MAX_SIZE=
+ BASE_TOKENIZER_DIR=/home/users/astar/cfar/stuananthu/LLMDiversity/results/qwen2-7b/phase5_sparsemax/checkpoint-1434
+ BASELINE_JSON=/home/users/astar/cfar/stuananthu/LLMDiversity/assets/gpt4_alpacaeval_responses.json
+ POEM_MAX=300
+ STORY_MAX=300
+ POEM_N=8
+ STORY_N=8
+ GEN_TOK_SHORT=256
+ mkdir -p /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009
+ EVAL_DIR_ALP=/home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca
+ EVAL_DIR_POEM=/home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_poem
+ EVAL_DIR_STORY=/home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_story
+ mkdir -p /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_poem /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_story
+ rm -f /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/responses.json /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_poem/responses.json /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_story/responses.json
++ hostname
+ export MASTER_ADDR=A484652X3B00163
+ MASTER_ADDR=A484652X3B00163
+ export MASTER_PORT=16583
+ MASTER_PORT=16583
+ GEN_EXTRA=()
+ [[ -n '' ]]
+ python /home/users/astar/cfar/stuananthu/LLMDiversity/hybrid_sft/evaluation/generate_response.py --model_name_or_path /home/users/astar/cfar/stuananthu/LLMDiversity/results/qwen2-7b/phase5_sparsemax/checkpoint-1434 --tokenizer_path /home/users/astar/cfar/stuananthu/LLMDiversity/results/qwen2-7b/phase5_sparsemax/checkpoint-1434 --dataset_path tatsu-lab/alpaca_eval --split eval --n 32 --batch_size 8 --use_vllm True --max_new_tokens 1024 --save_path /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/responses.json --remove_old
/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Downloading builder script:   0%|          | 0.00/8.09k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 8.09k/8.09k [00:00<00:00, 33.9kB/s]Downloading builder script: 100%|██████████| 8.09k/8.09k [00:00<00:00, 33.8kB/s]
Downloading readme:   0%|          | 0.00/30.0 [00:00<?, ?B/s]Downloading readme: 100%|██████████| 30.0/30.0 [00:00<00:00, 127B/s]Downloading readme: 100%|██████████| 30.0/30.0 [00:00<00:00, 126B/s]
Downloading data:   0%|          | 0.00/621k [00:00<?, ?B/s]Downloading data:  69%|██████▉   | 430k/621k [00:00<00:00, 1.65MB/s]Downloading data: 100%|██████████| 621k/621k [00:00<00:00, 2.34MB/s]
Generating eval split: 0 examples [00:00, ? examples/s]Generating eval split: 805 examples [00:00, 22224.22 examples/s]
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  2.06it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.85it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  1.85it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:01<00:00,  2.43it/s]
  0%|          | 0/101 [00:00<?, ?it/s]  1%|          | 1/101 [05:49<9:41:43, 349.03s/it]  2%|▏         | 2/101 [11:38<9:36:14, 349.24s/it]  3%|▎         | 3/101 [17:27<9:30:19, 349.18s/it]  4%|▍         | 4/101 [23:15<9:23:47, 348.73s/it]  5%|▍         | 5/101 [29:04<9:17:48, 348.63s/it]  6%|▌         | 6/101 [34:54<9:12:55, 349.21s/it]  7%|▋         | 7/101 [40:44<9:07:47, 349.66s/it]  8%|▊         | 8/101 [46:35<9:02:24, 349.95s/it]  9%|▉         | 9/101 [52:27<8:57:21, 350.46s/it] 10%|▉         | 10/101 [58:18<8:51:57, 350.74s/it] 11%|█         | 11/101 [1:04:09<8:46:17, 350.86s/it] 12%|█▏        | 12/101 [1:09:59<8:40:11, 350.70s/it] 13%|█▎        | 13/101 [1:15:50<8:34:26, 350.75s/it] 14%|█▍        | 14/101 [1:21:41<8:28:37, 350.77s/it] 15%|█▍        | 15/101 [1:27:33<8:23:03, 350.97s/it] 16%|█▌        | 16/101 [1:33:23<8:17:10, 350.94s/it] 17%|█▋        | 17/101 [1:39:14<8:11:01, 350.74s/it] 18%|█▊        | 18/101 [1:45:09<8:07:06, 352.13s/it] 19%|█▉        | 19/101 [1:51:06<8:03:03, 353.46s/it] 20%|█▉        | 20/101 [1:57:05<7:59:36, 355.27s/it] 21%|██        | 21/101 [2:02:58<7:52:51, 354.65s/it] 22%|██▏       | 22/101 [2:08:52<7:46:45, 354.50s/it] 23%|██▎       | 23/101 [2:14:46<7:40:17, 354.07s/it] 24%|██▍       | 24/101 [2:20:54<7:39:51, 358.33s/it] 25%|██▍       | 25/101 [2:26:45<7:31:01, 356.07s/it] 26%|██▌       | 26/101 [2:32:41<7:25:10, 356.15s/it] 27%|██▋       | 27/101 [2:38:33<7:17:42, 354.90s/it] 28%|██▊       | 28/101 [2:44:27<7:11:34, 354.72s/it] 29%|██▊       | 29/101 [2:50:20<7:04:57, 354.13s/it] 30%|██▉       | 30/101 [2:56:17<7:00:07, 355.03s/it] 31%|███       | 31/101 [3:02:07<6:52:24, 353.50s/it] 32%|███▏      | 32/101 [3:08:05<6:47:54, 354.70s/it] 33%|███▎      | 33/101 [3:13:56<6:40:57, 353.79s/it] 34%|███▎      | 34/101 [3:19:55<6:36:47, 355.33s/it] 35%|███▍      | 35/101 [3:25:56<6:32:41, 357.00s/it] 36%|███▌      | 36/101 [3:31:52<6:26:15, 356.55s/it] 37%|███▋      | 37/101 [3:37:44<6:18:53, 355.21s/it] 38%|███▊      | 38/101 [3:43:36<6:11:56, 354.23s/it] 39%|███▊      | 39/101 [3:49:29<6:05:49, 354.02s/it] 40%|███▉      | 40/101 [3:55:22<5:59:36, 353.71s/it] 41%|████      | 41/101 [4:01:20<5:55:03, 355.06s/it] 42%|████▏     | 42/101 [4:07:16<5:49:26, 355.36s/it] 43%|████▎     | 43/101 [4:13:40<5:51:49, 363.95s/it] 44%|████▎     | 44/101 [4:19:34<5:42:56, 360.99s/it] 45%|████▍     | 45/101 [4:25:26<5:34:10, 358.04s/it] 46%|████▌     | 46/101 [4:31:18<5:26:44, 356.45s/it] 47%|████▋     | 47/101 [4:37:13<5:20:16, 355.86s/it] 48%|████▊     | 48/101 [4:43:09<5:14:22, 355.90s/it] 49%|████▊     | 49/101 [4:49:00<5:07:16, 354.56s/it] 50%|████▉     | 50/101 [4:54:55<5:01:19, 354.50s/it] 50%|█████     | 51/101 [5:00:46<4:54:35, 353.51s/it] 51%|█████▏    | 52/101 [5:06:38<4:48:26, 353.20s/it] 52%|█████▏    | 53/101 [5:12:45<4:45:42, 357.14s/it] 53%|█████▎    | 54/101 [5:18:37<4:38:37, 355.69s/it] 54%|█████▍    | 55/101 [5:24:36<4:33:23, 356.59s/it] 55%|█████▌    | 56/101 [5:30:27<4:26:15, 355.01s/it] 56%|█████▋    | 57/101 [5:36:20<4:20:00, 354.56s/it] 57%|█████▋    | 58/101 [5:42:13<4:13:39, 353.95s/it] 58%|█████▊    | 59/101 [5:48:07<4:07:51, 354.08s/it] 59%|█████▉    | 60/101 [5:54:09<4:03:30, 356.35s/it] 60%|██████    | 61/101 [6:00:05<3:57:29, 356.25s/it] 61%|██████▏   | 62/101 [6:06:02<3:51:45, 356.55s/it] 62%|██████▏   | 63/101 [6:11:58<3:45:44, 356.44s/it] 63%|██████▎   | 64/101 [6:17:53<3:39:27, 355.87s/it] 64%|██████▍   | 65/101 [6:23:46<3:33:02, 355.06s/it] 65%|██████▌   | 66/101 [6:29:54<3:29:24, 358.99s/it] 66%|██████▋   | 67/101 [6:36:04<3:25:11, 362.12s/it] 67%|██████▋   | 68/101 [6:41:59<3:18:05, 360.17s/it] 68%|██████▊   | 69/101 [6:47:56<3:11:28, 359.01s/it] 69%|██████▉   | 70/101 [6:54:14<3:08:32, 364.92s/it] 70%|███████   | 71/101 [7:00:22<3:02:49, 365.64s/it] 71%|███████▏  | 72/101 [7:06:40<2:58:34, 369.48s/it] 72%|███████▏  | 73/101 [7:12:40<2:51:09, 366.75s/it] 73%|███████▎  | 74/101 [7:18:34<2:43:14, 362.77s/it] 74%|███████▍  | 75/101 [7:24:26<2:35:47, 359.51s/it] 75%|███████▌  | 76/101 [7:30:29<2:30:12, 360.48s/it] 76%|███████▌  | 77/101 [7:36:21<2:23:16, 358.20s/it] 77%|███████▋  | 78/101 [7:42:15<2:16:49, 356.92s/it] 78%|███████▊  | 79/101 [7:48:14<2:11:06, 357.56s/it] 79%|███████▉  | 80/101 [7:54:14<2:05:24, 358.29s/it] 80%|████████  | 81/101 [8:00:09<1:59:04, 357.23s/it] 81%|████████  | 82/101 [8:06:21<1:54:29, 361.57s/it] 82%|████████▏ | 83/101 [8:12:15<1:47:45, 359.21s/it] 83%|████████▎ | 84/101 [8:18:15<1:41:50, 359.45s/it] 84%|████████▍ | 85/101 [8:24:18<1:36:07, 360.48s/it] 85%|████████▌ | 86/101 [8:30:25<1:30:37, 362.49s/it] 86%|████████▌ | 87/101 [8:36:19<1:24:01, 360.11s/it] 87%|████████▋ | 88/101 [8:42:19<1:17:58, 359.89s/it] 88%|████████▊ | 89/101 [8:48:17<1:11:51, 359.30s/it] 89%|████████▉ | 90/101 [8:54:10<1:05:32, 357.53s/it] 90%|█████████ | 91/101 [9:00:06<59:31, 357.15s/it]   91%|█████████ | 92/101 [9:05:57<53:17, 355.26s/it] 92%|█████████▏| 93/101 [9:11:49<47:13, 354.24s/it] 93%|█████████▎| 94/101 [9:17:39<41:11, 353.06s/it] 94%|█████████▍| 95/101 [9:23:29<35:12, 352.14s/it] 95%|█████████▌| 96/101 [9:29:20<29:18, 351.63s/it] 96%|█████████▌| 97/101 [9:35:10<23:25, 351.28s/it] 97%|█████████▋| 98/101 [9:40:59<17:32, 350.70s/it] 98%|█████████▊| 99/101 [9:46:49<11:40, 350.46s/it] 99%|█████████▉| 100/101 [9:52:41<05:50, 350.70s/it]100%|██████████| 101/101 [9:58:14<00:00, 345.58s/it]100%|██████████| 101/101 [9:58:14<00:00, 355.39s/it]
+ rm -f /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/rewards.json /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/reward_summary.json
+ python /home/users/astar/cfar/stuananthu/LLMDiversity/hybrid_sft/evaluation/evaluation_reward.py --model_name_or_path sfairXC/FsfairX-LLaMA3-RM-v0.1 --tokenizer_path sfairXC/FsfairX-LLaMA3-RM-v0.1 --data_path /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/responses.json --batch_size 2 --save_path /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/rewards.json --summary_path /home/users/astar/cfar/stuananthu/LLMDiversity/evals/qwen2-7b/qwen2_sparsemax_eval_20250906-0009/evaluation_chat_alpaca/reward_summary.json --baseline_json /home/users/astar/cfar/stuananthu/LLMDiversity/assets/gpt4_alpacaeval_responses.json
/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Ignored error while writing commit hash to /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers/models--sfairXC--FsfairX-LLaMA3-RM-v0.1/refs/main: [Errno 28] No space left on device.
Fetching 4 files:   0%|          | 0/4 [00:00<?, ?it/s]/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 117.47 MB. The target location /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers/models--sfairXC--FsfairX-LLaMA3-RM-v0.1/blobs only has 0.00 MB free disk space.
  warnings.warn(
/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 4915.92 MB. The target location /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers/models--sfairXC--FsfairX-LLaMA3-RM-v0.1/blobs only has 0.00 MB free disk space.
  warnings.warn(
/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 4999.80 MB. The target location /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers/models--sfairXC--FsfairX-LLaMA3-RM-v0.1/blobs only has 0.00 MB free disk space.
  warnings.warn(
/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py:801: UserWarning: Not enough free disk space to download the file. The expected file size is: 4976.71 MB. The target location /scratch/prj0000000224/LLMDiversity_work/cache/huggingface/transformers/models--sfairXC--FsfairX-LLaMA3-RM-v0.1/blobs only has 0.00 MB free disk space.
  warnings.warn(
Fetching 4 files:   0%|          | 0/4 [00:13<?, ?it/s]
Traceback (most recent call last):
  File "/home/users/astar/cfar/stuananthu/LLMDiversity/hybrid_sft/evaluation/evaluation_reward.py", line 1292, in <module>
    main()
  File "/home/users/astar/cfar/stuananthu/LLMDiversity/hybrid_sft/evaluation/evaluation_reward.py", line 1147, in main
    model = AutoModelForSequenceClassification.from_pretrained(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 571, in from_pretrained
    return model_class.from_pretrained(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/modeling_utils.py", line 309, in _wrapper
    return func(*args, **kwargs)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/modeling_utils.py", line 4422, in from_pretrained
    checkpoint_files, sharded_metadata = _get_resolved_checkpoint_files(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/modeling_utils.py", line 1179, in _get_resolved_checkpoint_files
    checkpoint_files, sharded_metadata = get_checkpoint_shard_files(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/utils/hub.py", line 1110, in get_checkpoint_shard_files
    cached_filenames = cached_files(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/utils/hub.py", line 557, in cached_files
    raise e
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/transformers/utils/hub.py", line 485, in cached_files
    snapshot_download(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/_snapshot_download.py", line 332, in snapshot_download
    thread_map(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/tqdm/contrib/concurrent.py", line 69, in thread_map
    return _executor_map(ThreadPoolExecutor, fn, *iterables, **tqdm_kwargs)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/tqdm/contrib/concurrent.py", line 51, in _executor_map
    return list(tqdm_class(ex.map(fn, *iterables, chunksize=chunksize), **kwargs))
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/concurrent/futures/_base.py", line 621, in result_iterator
    yield _result_or_cancel(fs.pop())
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/concurrent/futures/_base.py", line 319, in _result_or_cancel
    return fut.result(timeout)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/concurrent/futures/_base.py", line 458, in result
    return self.__get_result()
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/_snapshot_download.py", line 306, in _inner_hf_hub_download
    return hf_hub_download(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1010, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1171, in _hf_hub_download_to_cache_dir
    _download_to_tmp_and_move(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1723, in _download_to_tmp_and_move
    xet_get(
  File "/home/users/astar/cfar/stuananthu/.conda/envs/hybrid_loss/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 629, in xet_get
    download_files(
RuntimeError: Data processing error: CAS service error : IO Error: No space left on device (os error 28)
